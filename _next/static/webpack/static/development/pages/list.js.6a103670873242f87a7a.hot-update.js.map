{"version":3,"file":"static/webpack/static/development/pages/list.js.6a103670873242f87a7a.hot-update.js","sources":["webpack:///./components/Collection.js","webpack:///./pages/list.js"],"sourcesContent":["import _ from \"lodash\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { withPropsOnChange } from \"recompose\";\nimport styled from \"styled-components\";\n\nconst replies = [\"申請前已對外提供\", \"同意提供\", \"不同意提供\", \"還未回覆\"];\n\nconst nameColors = [\"#aab6fe\", \"#b2fab4\", \"#ffa4a2\", \"#ffe97d\"];\nconst valueColors = [\"#49599a\", \"#519657\", \"#af4448\", \"#c88719\"];\n\nconst Wrapper = styled.div`\n  width: 100%;\n  margin: 0 auto;\n  flex: 1;\n  display: flex;\n  flex-direction: row;\n`;\n\nconst KindName = styled.div`\n  font-size: 1.5em;\n  flex: 1;\n  display: flex;\n  align-items: flex-end;\n  justify-content: flex-end;\n  padding: 0 20px 20px;\n  color: ${({ idx }) => nameColors[idx]};\n`;\n\nconst Bar = styled.div`\n  position: relative;\n  height: 100%;\n  width: 100%;\n  max-width: 600px;\n  display: flex;\n  flex-direction: row-reverse;\n  align-items: flex-end;\n`;\n\nconst Item = styled.div`\n  position: relative;\n  flex: 1;\n  background-color: rgba(255, 255, 255, 0.6);\n  margin: 0 5px;\n  height: ${({ value }) => value * 500}%;\n  transition-property: height;\n  transition-duration: 1s;\n  display: flex;\n  align-items: flex-end;\n  justify-content: center;\n  padding-bottom: 20px;\n  font-size: 1.2em;\n  color: ${({ idx }) => valueColors[idx]};\n`;\n\nconst Organizer = styled.div`\n  position: absolute;\n  top: -30px;\n  right: 0;\n  text-align: right;\n  width: 200px;\n  color: #ffffff;\n`;\n\nclass Rank extends React.PureComponent {\n  static propTypes = {\n    data: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  };\n\n  state = {\n    idx: 0,\n  };\n\n  componentDidMount() {\n    this.timer = setTimeout(this.onTimerTrigger, 5000);\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.timer);\n  }\n\n  onTimerTrigger = () => {\n    let { idx } = this.state;\n    idx += 1;\n    if (idx >= replies.length) idx = 0;\n    this.setState({ idx });\n    this.timer = setTimeout(this.onTimerTrigger, 5000);\n  };\n\n  render() {\n    const { data, ...props } = this.props;\n    const { idx } = this.state;\n    const results = _.orderBy(data, [replies[idx]], [\"desc\"]);\n    const total = _.sumBy(data, replies[idx]);\n\n    return (\n      <Wrapper {...props}>\n        <KindName idx={idx}>{replies[idx]}</KindName>\n        <Bar>\n          {_.map(_.take(results, 8), (result, index) => (\n            <Item key={index} value={result[replies[idx]] / total} idx={idx}>\n              <Organizer>{result.name}</Organizer>\n              {result[replies[idx]]}\n            </Item>\n          ))}\n        </Bar>\n      </Wrapper>\n    );\n  }\n}\n\nexport default Rank\n  |> withPropsOnChange([\"data\"], ({ data }) => {\n    const results = {};\n    _.forEach(data, item => {\n      if (\n        !item[\"標記用＿派發機關\"] ||\n        !item[\"0. 政府對民眾申請開放資料的答覆是？\"]\n      )\n        return;\n\n      const paths = [\n        item[\"標記用＿派發機關\"],\n        item[\"0. 政府對民眾申請開放資料的答覆是？\"],\n      ];\n      const value = _.get(results, paths, 0);\n      _.set(results, paths, value + 1);\n    });\n\n    return {\n      data: _.map(results, (result, name) => {\n        const item = { name: _.replace(name, \"政府\", \"\") };\n        _.forEach(replies, key => {\n          item[key] = result[key] || 0;\n        });\n        return item;\n      }),\n    };\n  });\n","import _ from \"lodash\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport styled from \"styled-components\";\nimport Link from \"next/link\";\nimport Head from \"../components/Head\";\nimport Rank from \"../components/Rank\";\nimport Collection from \"../components/Collection\";\n\nconst Topbar = styled.div`\n  height: 20px;\n`;\n\nconst Title = styled.div`\n  font-size: 1.5em;\n  padding: 3px 10px 3px 10px;\n  background: #ffffff;\n  display: inline-block;\n  border-radius: 3px;\n`;\n\nconst Document = styled.div`\n`;\n\nconst Header = styled.div`\n  width: 100%;\n  background-image: url(\"./static/background.jpg\");\n  background-size: cover;\n  background-position: center center;\n`;\n\nconst HeaderBackground = styled.div`\n  width: 100%;\n  padding-bottom: 5%;\n  background-color: rgba(10, 10, 10, 0.6);\n`;\n\nconst Container = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n`;\n\nconst Main = styled.div`\n  position: absolute;\n  top: 80px;\n  left: 0;\n  width: 50%;\n  height: calc(100% - 80px);\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: center;\n`;\n\nconst RankPanel = styled(Rank)`\n  margin-right: 0;\n`;\n\nconst GithubButton = styled.a`\n  color: #ffffff;\n  padding: 5px 0;\n  display: block;\n  &:hover {\n    color: #ffffff;\n  }\n`;\n\nexport default class Home extends React.PureComponent {\n  state = {\n    data: null,\n  };\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  async loadData() {\n    const res = await axios.get(\"./static/data.json\");\n    const raw = await res.data;\n    const fields = _.pullAt(raw, [0])[0];\n    const data = _.map(raw, item => _.mapKeys(item, (__, key) => fields[key]));\n    this.setState({ data });\n  }\n\n  renderList = () => {\n    const { data } = this.state;\n    if (!data) return;\n\n    console.log(data);\n    return _.map(data, (item, idx) => (\n      <div key={`${idx}-${item[\"原ID\"]}`}>{item[\"原ID\"]}</div>\n    ));\n  }\n\n  render() {\n    return (\n      <Document>\n        <Head title=\"資料申請小幫手\" />\n        <Header>\n          <HeaderBackground>\n            <Topbar />\n            <div className=\"container\">\n              <Title>資料申請小幫手</Title>\n              <GithubButton\n                target=\"_blank\"\n                href=\"https://github.com/opengovdatatw/dataopener\"\n              >\n                View on GitHub\n              </GithubButton>\n            </div>\n          </HeaderBackground>\n        </Header>\n        <Container className=\"container\">{this.renderList()}</Container>\n      </Document>\n    );\n  }\n}\n"],"mappings":"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","sourceRoot":""}